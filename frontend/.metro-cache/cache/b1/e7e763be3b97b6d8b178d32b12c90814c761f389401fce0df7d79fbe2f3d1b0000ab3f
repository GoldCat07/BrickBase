{"dependencies":[{"name":"tslib","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":16,"index":93},"end":{"line":3,"column":32,"index":109}}],"key":"vm88vOsSPZItrLOmMEyUuGkd1y4=","exportNames":["*"],"imports":1}},{"name":"./PostgrestQueryBuilder","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":56,"index":167},"end":{"line":4,"column":90,"index":201}}],"key":"6yLSRkTCaGyTSQvLUJvo14aYbi8=","exportNames":["*"],"imports":1}},{"name":"./PostgrestFilterBuilder","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":57,"index":261},"end":{"line":5,"column":92,"index":296}}],"key":"NGvdEkdD+wH/sBHVGxr/LfyZvLA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  const tslib_1 = require(_dependencyMap[0], \"tslib\");\n  const PostgrestQueryBuilder_1 = tslib_1.__importDefault(require(_dependencyMap[1], \"./PostgrestQueryBuilder\"));\n  const PostgrestFilterBuilder_1 = tslib_1.__importDefault(require(_dependencyMap[2], \"./PostgrestFilterBuilder\"));\n  /**\n   * PostgREST client.\n   *\n   * @typeParam Database - Types for the schema from the [type\n   * generator](https://supabase.com/docs/reference/javascript/next/typescript-support)\n   *\n   * @typeParam SchemaName - Postgres schema to switch to. Must be a string\n   * literal, the same one passed to the constructor. If the schema is not\n   * `\"public\"`, this must be supplied manually.\n   */\n  class PostgrestClient {\n    // TODO: Add back shouldThrowOnError once we figure out the typings\n    /**\n     * Creates a PostgREST client.\n     *\n     * @param url - URL of the PostgREST endpoint\n     * @param options - Named parameters\n     * @param options.headers - Custom headers\n     * @param options.schema - Postgres schema to switch to\n     * @param options.fetch - Custom fetch\n     * @example\n     * ```ts\n     * import PostgrestClient from '@supabase/postgrest-js'\n     *\n     * const postgrest = new PostgrestClient('https://xyzcompany.supabase.co/rest/v1', {\n     *   headers: { apikey: 'public-anon-key' },\n     *   schema: 'public',\n     * })\n     * ```\n     */\n    constructor(url, {\n      headers = {},\n      schema,\n      fetch\n    } = {}) {\n      this.url = url;\n      this.headers = new Headers(headers);\n      this.schemaName = schema;\n      this.fetch = fetch;\n    }\n    /**\n     * Perform a query on a table or a view.\n     *\n     * @param relation - The table or view name to query\n     */\n    from(relation) {\n      if (!relation || typeof relation !== 'string' || relation.trim() === '') {\n        throw new Error('Invalid relation name: relation must be a non-empty string.');\n      }\n      const url = new URL(`${this.url}/${relation}`);\n      return new PostgrestQueryBuilder_1.default(url, {\n        headers: new Headers(this.headers),\n        schema: this.schemaName,\n        fetch: this.fetch\n      });\n    }\n    /**\n     * Select a schema to query or perform an function (rpc) call.\n     *\n     * The schema needs to be on the list of exposed schemas inside Supabase.\n     *\n     * @param schema - The schema to query\n     */\n    schema(schema) {\n      return new PostgrestClient(this.url, {\n        headers: this.headers,\n        schema,\n        fetch: this.fetch\n      });\n    }\n    /**\n     * Perform a function call.\n     *\n     * @param fn - The function name to call\n     * @param args - The arguments to pass to the function call\n     * @param options - Named parameters\n     * @param options.head - When set to `true`, `data` will not be returned.\n     * Useful if you only need the count.\n     * @param options.get - When set to `true`, the function will be called with\n     * read-only access mode.\n     * @param options.count - Count algorithm to use to count rows returned by the\n     * function. Only applicable for [set-returning\n     * functions](https://www.postgresql.org/docs/current/functions-srf.html).\n     *\n     * `\"exact\"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the\n     * hood.\n     *\n     * `\"planned\"`: Approximated but fast count algorithm. Uses the Postgres\n     * statistics under the hood.\n     *\n     * `\"estimated\"`: Uses exact count for low numbers and planned count for high\n     * numbers.\n     *\n     * @example\n     * ```ts\n     * // For cross-schema functions where type inference fails, use overrideTypes:\n     * const { data } = await supabase\n     *   .schema('schema_b')\n     *   .rpc('function_a', {})\n     *   .overrideTypes<{ id: string; user_id: string }[]>()\n     * ```\n     */\n    rpc(fn, args = {}, {\n      head = false,\n      get = false,\n      count\n    } = {}) {\n      var _a;\n      let method;\n      const url = new URL(`${this.url}/rpc/${fn}`);\n      let body;\n      if (head || get) {\n        method = head ? 'HEAD' : 'GET';\n        Object.entries(args)\n        // params with undefined value needs to be filtered out, otherwise it'll\n        // show up as `?param=undefined`\n        .filter(([_, value]) => value !== undefined)\n        // array values need special syntax\n        .map(([name, value]) => [name, Array.isArray(value) ? `{${value.join(',')}}` : `${value}`]).forEach(([name, value]) => {\n          url.searchParams.append(name, value);\n        });\n      } else {\n        method = 'POST';\n        body = args;\n      }\n      const headers = new Headers(this.headers);\n      if (count) {\n        headers.set('Prefer', `count=${count}`);\n      }\n      return new PostgrestFilterBuilder_1.default({\n        method,\n        url,\n        headers,\n        schema: this.schemaName,\n        body,\n        fetch: (_a = this.fetch) !== null && _a !== void 0 ? _a : fetch\n      });\n    }\n  }\n  exports.default = PostgrestClient;\n});","lineCount":150,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0],[7,8,3,6,"tslib_1"],[7,15,3,13],[7,18,3,16,"require"],[7,25,3,23],[7,26,3,23,"_dependencyMap"],[7,40,3,23],[7,52,3,31],[7,53,3,32],[8,2,4,0],[8,8,4,6,"PostgrestQueryBuilder_1"],[8,31,4,29],[8,34,4,32,"tslib_1"],[8,41,4,39],[8,42,4,40,"__importDefault"],[8,57,4,55],[8,58,4,56,"require"],[8,65,4,63],[8,66,4,63,"_dependencyMap"],[8,80,4,63],[8,110,4,89],[8,111,4,90],[8,112,4,91],[9,2,5,0],[9,8,5,6,"PostgrestFilterBuilder_1"],[9,32,5,30],[9,35,5,33,"tslib_1"],[9,42,5,40],[9,43,5,41,"__importDefault"],[9,58,5,56],[9,59,5,57,"require"],[9,66,5,64],[9,67,5,64,"_dependencyMap"],[9,81,5,64],[9,112,5,91],[9,113,5,92],[9,114,5,93],[10,2,6,0],[11,0,7,0],[12,0,8,0],[13,0,9,0],[14,0,10,0],[15,0,11,0],[16,0,12,0],[17,0,13,0],[18,0,14,0],[19,0,15,0],[20,2,16,0],[20,8,16,6,"PostgrestClient"],[20,23,16,21],[20,24,16,22],[21,4,17,4],[22,4,18,4],[23,0,19,0],[24,0,20,0],[25,0,21,0],[26,0,22,0],[27,0,23,0],[28,0,24,0],[29,0,25,0],[30,0,26,0],[31,0,27,0],[32,0,28,0],[33,0,29,0],[34,0,30,0],[35,0,31,0],[36,0,32,0],[37,0,33,0],[38,0,34,0],[39,0,35,0],[40,4,36,4,"constructor"],[40,15,36,15,"constructor"],[40,16,36,16,"url"],[40,19,36,19],[40,21,36,21],[41,6,36,23,"headers"],[41,13,36,30],[41,16,36,33],[41,17,36,34],[41,18,36,35],[42,6,36,37,"schema"],[42,12,36,43],[43,6,36,45,"fetch"],[44,4,36,52],[44,5,36,53],[44,8,36,56],[44,9,36,57],[44,10,36,58],[44,12,36,60],[45,6,37,8],[45,10,37,12],[45,11,37,13,"url"],[45,14,37,16],[45,17,37,19,"url"],[45,20,37,22],[46,6,38,8],[46,10,38,12],[46,11,38,13,"headers"],[46,18,38,20],[46,21,38,23],[46,25,38,27,"Headers"],[46,32,38,34],[46,33,38,35,"headers"],[46,40,38,42],[46,41,38,43],[47,6,39,8],[47,10,39,12],[47,11,39,13,"schemaName"],[47,21,39,23],[47,24,39,26,"schema"],[47,30,39,32],[48,6,40,8],[48,10,40,12],[48,11,40,13,"fetch"],[48,16,40,18],[48,19,40,21,"fetch"],[48,24,40,26],[49,4,41,4],[50,4,42,4],[51,0,43,0],[52,0,44,0],[53,0,45,0],[54,0,46,0],[55,4,47,4,"from"],[55,8,47,8,"from"],[55,9,47,9,"relation"],[55,17,47,17],[55,19,47,19],[56,6,48,8],[56,10,48,12],[56,11,48,13,"relation"],[56,19,48,21],[56,23,48,25],[56,30,48,32,"relation"],[56,38,48,40],[56,43,48,45],[56,51,48,53],[56,55,48,57,"relation"],[56,63,48,65],[56,64,48,66,"trim"],[56,68,48,70],[56,69,48,71],[56,70,48,72],[56,75,48,77],[56,77,48,79],[56,79,48,81],[57,8,49,12],[57,14,49,18],[57,18,49,22,"Error"],[57,23,49,27],[57,24,49,28],[57,85,49,89],[57,86,49,90],[58,6,50,8],[59,6,51,8],[59,12,51,14,"url"],[59,15,51,17],[59,18,51,20],[59,22,51,24,"URL"],[59,25,51,27],[59,26,51,28],[59,29,51,31],[59,33,51,35],[59,34,51,36,"url"],[59,37,51,39],[59,41,51,43,"relation"],[59,49,51,51],[59,51,51,53],[59,52,51,54],[60,6,52,8],[60,13,52,15],[60,17,52,19,"PostgrestQueryBuilder_1"],[60,40,52,42],[60,41,52,43,"default"],[60,48,52,50],[60,49,52,51,"url"],[60,52,52,54],[60,54,52,56],[61,8,53,12,"headers"],[61,15,53,19],[61,17,53,21],[61,21,53,25,"Headers"],[61,28,53,32],[61,29,53,33],[61,33,53,37],[61,34,53,38,"headers"],[61,41,53,45],[61,42,53,46],[62,8,54,12,"schema"],[62,14,54,18],[62,16,54,20],[62,20,54,24],[62,21,54,25,"schemaName"],[62,31,54,35],[63,8,55,12,"fetch"],[63,13,55,17],[63,15,55,19],[63,19,55,23],[63,20,55,24,"fetch"],[64,6,56,8],[64,7,56,9],[64,8,56,10],[65,4,57,4],[66,4,58,4],[67,0,59,0],[68,0,60,0],[69,0,61,0],[70,0,62,0],[71,0,63,0],[72,0,64,0],[73,4,65,4,"schema"],[73,10,65,10,"schema"],[73,11,65,11,"schema"],[73,17,65,17],[73,19,65,19],[74,6,66,8],[74,13,66,15],[74,17,66,19,"PostgrestClient"],[74,32,66,34],[74,33,66,35],[74,37,66,39],[74,38,66,40,"url"],[74,41,66,43],[74,43,66,45],[75,8,67,12,"headers"],[75,15,67,19],[75,17,67,21],[75,21,67,25],[75,22,67,26,"headers"],[75,29,67,33],[76,8,68,12,"schema"],[76,14,68,18],[77,8,69,12,"fetch"],[77,13,69,17],[77,15,69,19],[77,19,69,23],[77,20,69,24,"fetch"],[78,6,70,8],[78,7,70,9],[78,8,70,10],[79,4,71,4],[80,4,72,4],[81,0,73,0],[82,0,74,0],[83,0,75,0],[84,0,76,0],[85,0,77,0],[86,0,78,0],[87,0,79,0],[88,0,80,0],[89,0,81,0],[90,0,82,0],[91,0,83,0],[92,0,84,0],[93,0,85,0],[94,0,86,0],[95,0,87,0],[96,0,88,0],[97,0,89,0],[98,0,90,0],[99,0,91,0],[100,0,92,0],[101,0,93,0],[102,0,94,0],[103,0,95,0],[104,0,96,0],[105,0,97,0],[106,0,98,0],[107,0,99,0],[108,0,100,0],[109,0,101,0],[110,0,102,0],[111,0,103,0],[112,4,104,4,"rpc"],[112,7,104,7,"rpc"],[112,8,104,8,"fn"],[112,10,104,10],[112,12,104,12,"args"],[112,16,104,16],[112,19,104,19],[112,20,104,20],[112,21,104,21],[112,23,104,23],[113,6,104,25,"head"],[113,10,104,29],[113,13,104,32],[113,18,104,37],[114,6,104,39,"get"],[114,9,104,42],[114,12,104,45],[114,17,104,50],[115,6,104,52,"count"],[116,4,104,59],[116,5,104,60],[116,8,104,63],[116,9,104,64],[116,10,104,65],[116,12,104,67],[117,6,105,8],[117,10,105,12,"_a"],[117,12,105,14],[118,6,106,8],[118,10,106,12,"method"],[118,16,106,18],[119,6,107,8],[119,12,107,14,"url"],[119,15,107,17],[119,18,107,20],[119,22,107,24,"URL"],[119,25,107,27],[119,26,107,28],[119,29,107,31],[119,33,107,35],[119,34,107,36,"url"],[119,37,107,39],[119,45,107,47,"fn"],[119,47,107,49],[119,49,107,51],[119,50,107,52],[120,6,108,8],[120,10,108,12,"body"],[120,14,108,16],[121,6,109,8],[121,10,109,12,"head"],[121,14,109,16],[121,18,109,20,"get"],[121,21,109,23],[121,23,109,25],[122,8,110,12,"method"],[122,14,110,18],[122,17,110,21,"head"],[122,21,110,25],[122,24,110,28],[122,30,110,34],[122,33,110,37],[122,38,110,42],[123,8,111,12,"Object"],[123,14,111,18],[123,15,111,19,"entries"],[123,22,111,26],[123,23,111,27,"args"],[123,27,111,31],[124,8,112,16],[125,8,113,16],[126,8,113,16],[126,9,114,17,"filter"],[126,15,114,23],[126,16,114,24],[126,17,114,25],[126,18,114,26,"_"],[126,19,114,27],[126,21,114,29,"value"],[126,26,114,34],[126,27,114,35],[126,32,114,40,"value"],[126,37,114,45],[126,42,114,50,"undefined"],[126,51,114,59],[127,8,115,16],[128,8,115,16],[128,9,116,17,"map"],[128,12,116,20],[128,13,116,21],[128,14,116,22],[128,15,116,23,"name"],[128,19,116,27],[128,21,116,29,"value"],[128,26,116,34],[128,27,116,35],[128,32,116,40],[128,33,116,41,"name"],[128,37,116,45],[128,39,116,47,"Array"],[128,44,116,52],[128,45,116,53,"isArray"],[128,52,116,60],[128,53,116,61,"value"],[128,58,116,66],[128,59,116,67],[128,62,116,70],[128,66,116,74,"value"],[128,71,116,79],[128,72,116,80,"join"],[128,76,116,84],[128,77,116,85],[128,80,116,88],[128,81,116,89],[128,84,116,92],[128,87,116,95],[128,90,116,98,"value"],[128,95,116,103],[128,97,116,105],[128,98,116,106],[128,99,116,107],[128,100,117,17,"forEach"],[128,107,117,24],[128,108,117,25],[128,109,117,26],[128,110,117,27,"name"],[128,114,117,31],[128,116,117,33,"value"],[128,121,117,38],[128,122,117,39],[128,127,117,44],[129,10,118,16,"url"],[129,13,118,19],[129,14,118,20,"searchParams"],[129,26,118,32],[129,27,118,33,"append"],[129,33,118,39],[129,34,118,40,"name"],[129,38,118,44],[129,40,118,46,"value"],[129,45,118,51],[129,46,118,52],[130,8,119,12],[130,9,119,13],[130,10,119,14],[131,6,120,8],[131,7,120,9],[131,13,121,13],[132,8,122,12,"method"],[132,14,122,18],[132,17,122,21],[132,23,122,27],[133,8,123,12,"body"],[133,12,123,16],[133,15,123,19,"args"],[133,19,123,23],[134,6,124,8],[135,6,125,8],[135,12,125,14,"headers"],[135,19,125,21],[135,22,125,24],[135,26,125,28,"Headers"],[135,33,125,35],[135,34,125,36],[135,38,125,40],[135,39,125,41,"headers"],[135,46,125,48],[135,47,125,49],[136,6,126,8],[136,10,126,12,"count"],[136,15,126,17],[136,17,126,19],[137,8,127,12,"headers"],[137,15,127,19],[137,16,127,20,"set"],[137,19,127,23],[137,20,127,24],[137,28,127,32],[137,30,127,34],[137,39,127,43,"count"],[137,44,127,48],[137,46,127,50],[137,47,127,51],[138,6,128,8],[139,6,129,8],[139,13,129,15],[139,17,129,19,"PostgrestFilterBuilder_1"],[139,41,129,43],[139,42,129,44,"default"],[139,49,129,51],[139,50,129,52],[140,8,130,12,"method"],[140,14,130,18],[141,8,131,12,"url"],[141,11,131,15],[142,8,132,12,"headers"],[142,15,132,19],[143,8,133,12,"schema"],[143,14,133,18],[143,16,133,20],[143,20,133,24],[143,21,133,25,"schemaName"],[143,31,133,35],[144,8,134,12,"body"],[144,12,134,16],[145,8,135,12,"fetch"],[145,13,135,17],[145,15,135,19],[145,16,135,20,"_a"],[145,18,135,22],[145,21,135,25],[145,25,135,29],[145,26,135,30,"fetch"],[145,31,135,35],[145,37,135,41],[145,41,135,45],[145,45,135,49,"_a"],[145,47,135,51],[145,52,135,56],[145,57,135,61],[145,58,135,62],[145,61,135,65,"_a"],[145,63,135,67],[145,66,135,70,"fetch"],[146,6,136,8],[146,7,136,9],[146,8,136,10],[147,4,137,4],[148,2,138,0],[149,2,139,0,"exports"],[149,9,139,7],[149,10,139,8,"default"],[149,17,139,15],[149,20,139,18,"PostgrestClient"],[149,35,139,33],[150,0,139,34],[150,3]],"functionMap":{"names":["<global>","PostgrestClient","constructor","from","schema","rpc","Object.entries.filter$argument_0","Object.entries.filter.map$argument_0","Object.entries.filter.map.forEach$argument_0"],"mappings":"AAA;ACe;ICoB;KDK;IEM;KFU;IGQ;KHM;IIiC;wBCU,mCD;qBEE,qFF;yBGC;aHE;KJkB;CDC"},"hasCjsExports":true},"type":"js/module"}]}